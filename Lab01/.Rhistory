## For some convenience functions to calculate statistics on matrices
library(matrixStats)
train <- Smarket$Year < 2005
Smarket.2005 <- Smarket[!train,]
Direction.2005 <- Smarket.2005$Direction
## For some datasets
library(ISLR)
## For qda()
library(MASS)
## For knn()
library(class)
## For multinom()
library(nnet)
## For some convenience functions to calculate statistics on matrices
library(matrixStats)
train <- Smarket$Year < 2005
Smarket.2005 <- Smarket[!train,]
Direction.2005 <- Smarket.2005$Direction
train <- Smarket$Year < 2005
Smarket.2005 <- Smarket[!train,]
Direction.2005 <- Smarket.2005$Direction
qda.fit <- qda ( Direction ~ Lag1 + Lag2, data = Smarket,  subset = train )
qda.fit
qda.class <- predict (qda.fit, Smarket.2005)$class
table(qda.class, Direction.2005)
mean(qda.class == Direction.2005)
dat <- read.table("olive.dat", header=TRUE)
dat <- read.table("olive.dat", header=TRUE)
fit.mn <- multinom(group.id ~ . , data=dat)
str(dat)
summary(dat)
class.pred.mn <- predict(fit.mn)
table(class.pred.mn, dat$group.id)
mean(class.pred.mn != dat$group.id)
fit.lda <- lda(group.id ~ ., data=dat)
class.pred.lda <- predict(fit.lda)$class
mean(class.pred.lda != dat$group.id)
fit.qda <- qda(group.id ~ ., data=dat)
class.pred.qda <- predict(fit.qda)$class
table(class.pred.qda, dat$group.id)
mean(class.pred.qda != dat$group.id)
set.seed(4064)
class.knn <- knn(dat[,-1], dat[,-1], dat[,1], k = 3)
table(class.knn, dat$group.id)
mean(class.knn != dat$group.id)
table(class.pred.lda, dat$group.id)
table(class.knn, dat$group.id)
mean(class.knn != dat$group.id)
idx <- 1:NROW(dat)
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
idx <- 1:NROW(dat)
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
print(dat)
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
sds <- tapply(idx, dat$group.id, function(i) colSds(data.matrix(dat[i,-1])))
pis <- tapply(idx, dat$group.id, function(i) length(i))
sds <- tapply(idx, dat$group.id, function(i) colSds(data.matrix(dat[i,-1])))
pis <- tapply(idx, dat$group.id, function(i) length(i))
sds <- tapply(idx, dat$group.id, function(i) colSds(data.matrix(dat[i,-1])))
pis <- tapply(idx, dat$group.id, function(i) length(i))
x <- dat[1, -1]
-sum(((x-means[[1]])/sds[[1]])^2 + 2*log(sds[[1]]))/2 + log(pis[1])
sds <- tapply(idx, dat$group.id, function(i) colSds(data.matrix(dat[i,-1])))
pis <- tapply(idx, dat$group.id, function(i) length(i))
x <- dat[1, -1]
-sum(((x-means[[1]])/sds[[1]])^2 + 2*log(sds[[1]]))/2 + log(pis[1])
sds <- tapply(idx, dat$group.id, function(i) colSds(data.matrix(dat[i,-1])))
pis <- tapply(idx, dat$group.id, function(i) length(i))
x <- dat[1, -1]
-sum(((x-means[[1]])/sds[[1]])^2 + 2*log(sds[[1]]))/2 + log(pis[1])
means
head(dat)
sds <- tapply(idx, dat$group.id, function(i) colSds(data.matrix(dat[i,-1])))
pis <- tapply(idx, dat$group.id, function(i) length(i))
sapply(1:length(means), function(i) -sum(((x-means[[i]])/sds[[i]])^2 + 2*log(sds[[i]]))/2 + log(pis[i]))
nb <- function(x){
sapply(1:length(means), function(i) -sum(((x-means[[i]])/sds[[i]])^2 + 2*log(sds[[i]]))/2 + log(pis[i]))
}
nb <- function(x){
