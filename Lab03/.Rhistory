class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat$group.id)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat$group.id)
mean(class.nb != dat$group.id)
set.seed(123456)
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx <- unlist(idx)
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx <- unlist(idx)
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
?unlist
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx
idx <- unlist(idx)
idx
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx
idx <- unlist(idx)
idx
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
fit.lda <- lda(group.id ~ ., data=dat.train)
class.pred.lda <- predict(fit.lda, newdata=dat.test)$class
table(class.pred.lda, dat.test$group.id)
mean(class.pred.lda != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
idx <- 1:NROW(dat.train)
means <- tapply(idx, dat.train$group.id, function(i) colMeans(dat.train[i,-1]))
sds <- tapply(idx, dat.train$group.id, function(i) colSds(data.matrix(dat.train[i,-1])))
pis <- tapply(idx, dat.train$group.id, function(i) length(i))
discriminant.scores <- apply(dat.test[,-1], 1, nb)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat.test$group.id)
mean(class.nb != dat.test$group.id)
?tapply
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
idx <- 1:NROW(dat)
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
means <- tapply(idx, dat$group.id, function(i) colMeans(dat[i,-1]))
idx <- 1:NROW(dat.train)
means <- tapply(idx, dat.train$group.id, function(i) colMeans(dat.train[i,-1]))
sds <- tapply(idx, dat.train$group.id, function(i) colSds(data.matrix(dat.train[i,-1])))
pis <- tapply(idx, dat.train$group.id, function(i) length(i))
discriminant.scores <- apply(dat.test[,-1], 1, nb)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat.test$group.id)
mean(class.nb != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
set.seed(123456)
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx <- unlist(idx)
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
set.seed(123456)
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx <- unlist(idx)
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
fit.lda <- lda(group.id ~ ., data=dat.train)
class.pred.lda <- predict(fit.lda, newdata=dat.test)$class
table(class.pred.lda, dat.test$group.id)
mean(class.pred.lda != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
idx <- 1:NROW(dat.train)
means <- tapply(idx, dat.train$group.id, function(i) colMeans(dat.train[i,-1]))
sds <- tapply(idx, dat.train$group.id, function(i) colSds(data.matrix(dat.train[i,-1])))
pis <- tapply(idx, dat.train$group.id, function(i) length(i))
discriminant.scores <- apply(dat.test[,-1], 1, nb)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat.test$group.id)
mean(class.nb != dat.test$group.id)
fit.lda <- lda(group.id ~ ., data=dat.train)
class.pred.lda <- predict(fit.lda, newdata=dat.test)$class
table(class.pred.lda, dat.test$group.id)
mean(class.pred.lda != dat.test$group.id)
set.seed(123456)
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx <- unlist(idx)
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
set.seed(12345)
idx <- tapply(1:NROW(dat), dat$group.id, function(x) sample(x, length(x)/2))
idx <- unlist(idx)
dat.train <- dat[idx,]
dat.test <- dat[-idx,]
fit.mn <- multinom(group.id ~ . , data=dat.train)
class.pred.mn <- predict(fit.mn, newdata=dat.test)
table(class.pred.mn, dat.test$group.id)
mean(class.pred.mn != dat.test$group.id)
fit.lda <- lda(group.id ~ ., data=dat.train)
class.pred.lda <- predict(fit.lda, newdata=dat.test)$class
table(class.pred.lda, dat.test$group.id)
mean(class.pred.lda != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
idx <- 1:NROW(dat.train)
means <- tapply(idx, dat.train$group.id, function(i) colMeans(dat.train[i,-1]))
sds <- tapply(idx, dat.train$group.id, function(i) colSds(data.matrix(dat.train[i,-1])))
pis <- tapply(idx, dat.train$group.id, function(i) length(i))
discriminant.scores <- apply(dat.test[,-1], 1, nb)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat.test$group.id)
mean(class.nb != dat.test$group.id)
idx <- 1:NROW(dat.train)
means <- tapply(idx, dat.train$group.id, function(i) colMeans(dat.train[i,-1]))
sds <- tapply(idx, dat.train$group.id, function(i) colSds(data.matrix(dat.train[i,-1])))
pis <- tapply(idx, dat.train$group.id, function(i) length(i))
discriminant.scores <- apply(dat.test[,-1], 1, nb)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat.test$group.id)
mean(class.nb != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
fit.qda <- qda(group.id ~ ., data=dat.train)
class.pred.qda <- predict(fit.qda, newdata=dat.test)$class
table(class.pred.qda, dat.test$group.id)
mean(class.pred.qda != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
idx <- 1:NROW(dat.train)
means <- tapply(idx, dat.train$group.id, function(i) colMeans(dat.train[i,-1]))
sds <- tapply(idx, dat.train$group.id, function(i) colSds(data.matrix(dat.train[i,-1])))
pis <- tapply(idx, dat.train$group.id, function(i) length(i))
discriminant.scores <- apply(dat.test[,-1], 1, nb)
class.nb <- apply(discriminant.scores, 2, which.max)
table(class.nb, dat.test$group.id)
mean(class.nb != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(true= class.knn, dat.test$group.id)
mean(class.knn != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(true= class.knn, prediction = dat.test$group.id)
mean(class.knn != dat.test$group.id)
class.knn <- knn(dat.train[,-1], dat.test[,-1], dat.train[,1], k = 3)
table(pred= class.knn, true = dat.test$group.id)
mean(class.knn != dat.test$group.id)
table(true = dat.test$group.id, pred= class.knn)
View(test)
library(ISLR)
#Question 1 a
head(Auto)
is.na(Auto)
Auto <- na.omit(Auto)
Auto
?na.omit
dim(Auto)
colnames(AUto)
colnames(Auto)
library(MASS)
?parcoord
Auto[,1:7]
colnames(Auto[,1:7])
ppcocaine <- Auto[,1:7]
p <- Auto[,1:7]
parcoord(p)
parcoord(p, col = rainbow)
?parcoord
my_colors <- colors()[as.numeric(colnames(Auto))
my_colors <- colors()[as.numeric(colnames(Auto))]
my_colors <- colors()[as.numeric(colnames(Auto))]
my_colors <- colors()[as.numeric(colnames(Auto))*8]
my_colors
my_colors <- colors()
my_colors
my_colors <- colors()[1:8]
my_colors <- colors()[1:7]
myparcoord(p, col = my_colors)
parcoord(p, col = my_colors)
my_colors <- sample(colors(),7)
parcoord(p, col = my_colors)
corr(p)
cor(p)
cor(p)
max(corr(p))
Auto[,"year"]
?with
?which
which(Auto, "Year" >= 73)
which(Auto$Year >= 73)
with(Auto, which(Auto$Year >= 73))
Auto$year
Auto[Auto[,"Year"]>=73]
Auto[Auto[,"Year"],]>=73
Auto[Auto[,"Year"]]
Auto[,Auto[,"Year"]]
Auto[,Auto["Year"]]
?filtre
?filter
Auto[which(Auto[,"Year"]>=74),]
Auto[which(Auto[,"year"]>=74),]
Auto73 <- Auto[which(Auto[,"year"]>=73),]
source('H:/prac_exam.R')
source('H:/prac_exam.R')
nrow(Auto73)
M1 <- lm(acceleration~horsepower, Auto73)
?plot
library(ggplot2)
summary(M1)
plot(horsepower, acceleration, main = "Acceleration based on Horsepower for cars post-1972", sub = "acceleration = 20.667 - 0.049 * horsepower")
plot(horsepower, acceleration, data = Auto73, main = "Acceleration based on Horsepower for cars post-1972", sub = "acceleration = 20.667 - 0.049 * horsepower")
colnames(Auto73)
Auto73 <- Auto[which(Auto[,"year"]>=73),]
nrow(Auto73)
M1 <- lm(acceleration~horsepower, Auto73)
plot(horsepower, acceleration, data = Auto73, main = "Acceleration based on Horsepower for cars post-1972", sub = "acceleration = 20.667 - 0.049 * horsepower")
summary(M1)
colnames(Auto73)
plot(horsepower, acceleration, data = Auto73, main = "Acceleration based on Horsepower for cars post-1972", sub = "acceleration = 20.667 - 0.049 * horsepower")
plot(Auto73$horsepower, Auto73$acceleration, main = "Acceleration based on Horsepower for cars post-1972", sub = "acceleration = 20.667 - 0.049 * horsepower")
plot(Auto73$horsepower, Auto73$acceleration, xlab = "horsepower", ylab = "acceleration", main = "Acceleration based on Horsepower for cars post-1972", sub = "acceleration = 20.667 - 0.049 * horsepower")
plot(M1)
?rstandard
M1.res <- resid(M1)
plot(Auto73$acceleration, M1.res,
+     ylab="Residuals", xlab="Horsepower",
+     main="Auto73 Accelerations")
plot(Auto73$acceleration, M1.res,
+     ylab="Residuals", xlab="Horsepower",
+     main="Auto73 Accelerations")
plot(Auto73$acceleration, M1.res,
+     ylab="Residuals", xlab="Horsepower",
+     main="Auto73 Accelerations")
plot(Auto73$acceleration, M1.res, ylab="Residuals", xlab="Horsepower",main="Auto73 Accelerations")
abline(0, 0)
?abline
plot(Auto73$acceleration, M1.res, ylab="Residuals", xlab="Horsepower",main="Auto73 Accelerations")
abline(0, 0)
abline(2,1)
abline(-2,1)
plot(Auto73$acceleration, M1.res, ylab="Residuals", xlab="Horsepower",main="Auto73 Accelerations")
abline(0, 0)
plot(M1)
?predict
predict(M1, horsepower = 93)
fitted(M1, horsepower = 93)
fitted(M1, horsepower = 93)
fitted(M1, data.frame(x=x[93]))
fitted(M1, 93)
fitted(M1, horsepower = 93)
# 175
confint(M1, level=0.95)
Auto$mpgclass <- ifelse(Auto$mpg <= 23, 0, 1)
Auto$mpgclass
table(Auto$mpgclass )
M2 <- glm(mpgclass ~ weight + horsepower + acceleration, data = Auto, family = "binomial")
summary(M2)
source('H:/prac_exam.R')
predict(M1, newdata = newdf, type = "response")
newdf <- data.frame(horsepower = c(93,175))
predict(M1, newdata = newdf, type = "response")
?confint
predict(M1, newdata = newdf, interval = c("confidence", "prediction"),level = 0.95,type = "response")
predict(M1, newdata = newdf, interval = c("prediction"), level = 0.95, type = "response")
predict(M1, newdata = newdf, interval = c("confidence"), level = 0.95, type = "response")
pred.train <- factor(predict(M2, type = "response") > 0.5 , labels = c(0,1))
pred.test <- factor(predict(M2, newdata = Auto, type = "response") > 0.5, labels = c(0,1))
labs <- Auto$mpgclass
xtabs(~Y + pred.train, labs)
xtabs(~Y + pred.test, labs)
M2 <- glm(mpgclass ~ weight + horsepower + acceleration, data = Auto, family = "binomial")
summary(M2)
pred.train <- factor(predict(M2, type = "response") > 0.5 , labels = c(0,1))
pred.test <- factor(predict(M2, newdata = Auto, type = "response") > 0.5, labels = c(0,1))
labs <- Auto$mpgclass
xtabs(~Y + pred.train, labs)
xtabs(~Y + pred.test, labs)
head(pred.test)
table(pred.test)
table(labs)
xtabs(~Y + pred.train, labs)
xtabs(~Y + pred.test, labs)
dim(Carseats)
colnames(dim(Carseats)
)
colnames(dim(Carseats)
colnames(Carseats)
colnames(Carseats)
head(Carseats)
?Carseats
Carseats[,-'Shelveloc']
Carseats[,-'ShelveLoc']
Carseats[,-ShelveLoc]
Carseats[,"ShelveLoc"]
colnames(Carseats)
Carseats[,c(1:6,8:)
Carseats[,c(1:6,8:11
Carseats[,c(1:6,8:11)]
Carseats[,c(-7)]
colnames(Carseats[,c(-7)])
carseat10 <- Carseats[,c(-7)]
Carseats10 <- Carseats[,c(-7)]
?kmeans
kmeans(Carseats10, 2, nstart=20)
km.out <- kmeans(Carseats10, 2, nstart=20)
km.out$cluster
km.out <- kmeans(Carseats10, 2, nstart=20)
km.out$cluster
Carseats10 <- Carseats[,c(-7)]
km.out <- kmeans(Carseats10, 2, nstart=20)
km.out$cluster
Carseats10
km.out <- kmeans(Carseats10,centers= 2, nstart=20)
km.out$cluster
is.na(Carseats10)
summary(Carseats10)
dim(Carseats)
dim(Carseats10)
km.out <- kmeans(Carseats10,2, nstart=20)
sum(sapply(Carseats10, is.na))
sum(sapply(Carseats10, is.infinite))
sum(sapply(Carseats10, is.nan))
colnames(Carseats10)
str(Carseats10)
head(Carseats10)
Carseats10$Urban <- ifelse(Carseats10$Urban == "Yes", 1, 0)
km.out <- kmeans(Carseats10,2, nstart=20)
Carseats10$US <- ifelse(Carseats10$US == "Yes", 1, 0)
km.out <- kmeans(Carseats10,2, nstart=20)
km.out#clusters
km.out <- kmeans(Carseats10,2, nstart=20)
km.out$clusters
km.out
km.out$cluster
table(km.out$cluster)
km.out
km.out
km.out <- kmeans(Carseats10,2, nstart=20)
km.out
km.out$size
km.out$totss
km.out$withinss
km.out$betweenss
km.out$tot.withinss
(58-12)/58
source('H:/prac_exam.R')
P_within <- pnorm(1.96) - pnorm(-1.96)
# Probability of success, that one of the X's will not fall into the interval [-1.96, 1.96]
P_out <- 1 - P_in
# At least 1 X will not fall in interval (at least one success)
pbinom(9, 10, P_in)
# Exactly one Xi's will not fall in interval
dbinom(1, 10, P_out)
# Exactly two Xi's will not fall in interval
dbinom(2, 10, P_out)
P_within <- pnorm(1.96) - pnorm(-1.96)
# Probability of success, that one of the X's will not fall into the interval [-1.96, 1.96]
P_out <- 1 - P_in
P_in <- pnorm(1.96) - pnorm(-1.96)
# Probability of success, that one of the X's will not fall into the interval [-1.96, 1.96]
P_out <- 1 - P_in
# At least 1 X will not fall in interval (at least one success)
pbinom(9, 10, P_in)
# Exactly one Xi's will not fall in interval
dbinom(1, 10, P_out)
# Exactly two Xi's will not fall in interval
dbinom(2, 10, P_out)
p_out
P_out
# Probability of success, that one of the X's will not fall into the interval [-1.96, 1.96]
P_out <- 1 - P_in
P_in <- pnorm(1.96) - pnorm(-1.96)
# Probability of success, that one of the X's will not fall into the interval [-1.96, 1.96]
P_out <- 1 - P_in
# At least 1 X will not fall in interval (at least one success)
pbinom(9, 10, P_in)
# Exactly one Xi's will not fall in interval
dbinom(1, 10, P_out)
# Exactly two Xi's will not fall in interval
dbinom(2, 10, P_out)
## Task 2(written in BUGS or Stan).Find the probability with which each of the above events happen using a simulation study
# At least 1 X will not fall in interval (at least one success)
pbinom(9, 10, P_in)
?dbinom
# At least 1 X will not fall in interval (at least one success)
pbinom(9, 10, P_in)
# Exactly one Xi's will not fall in interval
dbinom(1, 10, P_out)
?print
print(cum)
# confirm cumulative probabilities add up
cum <- 0
for (i in range 1:10){
cum <- cum + dbinom(1, 10, P_out)
}
for (i in 1:10){
cum <- cum + dbinom(i, 10, P_out)
}
print(cum)
# Exactly one Xi's will not fall in interval
dbinom(1, 10, P_out)
# Exactly two Xi's will not fall in interval
dbinom(2, 10, P_out)
# confirm cumulative probabilities add up
cum <- 0
for (i in 1:10){
cum <- cum + dbinom(i, 10, P_out)
}
print(cum)
cum == pbinom(9, 10, P_in)
pbinom(9, 10, P_in)
cum == pbinom(9, 10, P_in)
identical(cum,pbinom(9, 10, P_in) )
(E <- all.equal(cum, pbinom(9, 10, P_in)))
identical(TRUE, E)
all.equal(cum, pbinom(9, 10, P_in))
?all.equal
if all.equal(cum, pbinom(9, 10, P_in)){
print("Looks corret (finger's crossed!")
}
if all.equal(cum, pbinom(9, 10, P_in))==TRUE{
print("Looks corret (finger's crossed!")
}
if (all.equal(cum, pbinom(9, 10, P_in))==TRUE) {
print("Looks corret (finger's crossed!")
}
if (all.equal(cum, pbinom(9, 10, P_in))==TRUE) {
print("Looks corret (finger's crossed!)")
}
1.96
P_in <- pnorm(1.96) - pnorm(-1.96)
# Probability of success, that one of the X's will not fall into the interval [-1.96, 1.96]
P_out <- 1 - P_in
# At least 1 X will not fall in interval (at least one success)
pbinom(9, 10, P_in)
# Exactly one Xi's will not fall in interval
dbinom(1, 10, P_out)
# Exactly two Xi's will not fall in interval
dbinom(2, 10, P_out)
knitr::opts_chunk$set(echo = TRUE,
tidy=TRUE)
cat(readLines("Binomial.bug"), sep="\n")
setwd("H:/bayesian/Lab03")
cat(readLines("Binomial.bug"), sep="\n")
knitr::opts_chunk$set(echo = TRUE,
tidy=TRUE)
cat(readLines("Binomial.bug"), sep="\n")
modelCheck("Binomial.bug")
library(BRugs)
modelCheck("Binomial.bug")
y <- 12
bugsData(list("y"), file="data.txt")
modelData("data.txt")
